<html>
<head>
    <!-- CSS styles -->
    <title>Houston Museums</title>
    <style type="text/css"> html, body { font-family: Arial, sans-serif; height: 100%; margin: 0; padding: 0; } .container { height: 100%; position: relative; } input { font-size: 12px; } h1 { color: #525454; font-size: 22px; margin: 0 0 10px 0; text-align: center; } #map { bottom: 0px; height: 100%; left: 362px; position: absolute; right: 0px; } .options-box { background: #fff; border: 1px solid #999; border-radius: 3px; height: 100%; line-height: 35px; padding: 10px 10px 30px 10px; text-align: left; width: 340px; }
    </style>
    <script src="js/knockout.js"></script>
</head>
<body>
    <div class="container">
    	<div class="options-box">
    		<h1>Find a Museum in Houston!</h1><hr>
    		<div>
    			<!--<input data-bind="value: search" /><button id="search-button" type="button">Search</button>--><hr>
                <ul id="locations-list" data-bind="template: { name: 'profileListTemplate', foreach: locationsList }">
                    <script type="text/html" id="profileListTemplate">
                        <li id="locations-list-item"><strong data-bind="text: $data"></strong><hr></li>
                    </script>
                </ul>
    		</div>
    	</div>
    </div>
    <div id="map"></div>
    <script>
        // Create a global variable to represent the map
   	    var map;
        // Create a blank array for the locations we want to use
        var locations = [];
        // Create a blank array for the markers we want shown on the map
   		var markers = [];
        var marker;
        // Create a blank array for the list we want shown in the search pane
        var list = [];
        // Create a blank array for the styles we want to apply to the map
        var styles = [];
        // Create the data Model to store information manipulated by the view model and displayed in the views
        var Model = {
            locations: [
                {title: 'Asia Society Texas Center', location: {lat: 29.726287, lng: -95.384678, tags: [ 'culture', 'art', 'history', 'education' ]}},
                {title: 'Buffalo Soldiers Museum', location: {lat: 29.735910, lng: -95.378052}, tags: [ 'military', 'history', 'culture', 'education' ]},
                {title: 'Childrens Museum of Houston', location: {lat: 29.722793, lng: -95.385225}, tags: [ 'family', 'science', 'education' ]},
                {title: 'Contemporary Arts Museum Houston', location: {lat: 29.726333, lng: -95.391465}, tags: [ 'art' ]},
                {title: 'Czech Center Museum Houston', location: {lat: 29.728954, lng: -95.384915}, tags: [ 'culture', 'history', 'education' ]},
                {title: 'DiverseWorks', location: {lat: 29.740289, lng: -95.378852}, tags: [ 'art', 'education' ]},
                {title: 'Holocaust Museum Houston', location: {lat: 29.725153, lng: -95.385660}, tags: [ 'history', 'education' ]},
                {title: 'Houston Center for Contemporary Craft', location: {lat: 29.730541, lng: -95.386025}, tags: [ 'art', 'education' ]},
                {title: 'Houston Center for Photography', location: {lat: 29.738381, lng: -95.397273}, tags: [ 'art' ]},
                {title: 'Houston Museum of African American Culture', location: {lat: 29.729538, lng: -95.382399}, tags: [ 'history', 'education', 'culture' ]},
                {title: 'Houston Museum of Natural Science', location: {lat: 29.721802, lng: -95.389942}},
                {title: 'Houston Zoo', location: {lat: 29.716094, lng: -95.390114}},
                {title: 'Lawndale Art Center', location: {lat: 29.729880, lng: -95.386574}},
                {title: 'Rice Gallery', location: {lat: 29.718329, lng: -95.397927}},
                {title: 'Rothko Chapel', location: {lat: 29.737624, lng: -95.396166}},
                {title: 'The Health Museum', location: {lat: 29.721698, lng: -95.386011}},
                {title: 'The Jung Center', location: {lat: 29.726789, lng: -95.391392}},
                {title: 'The Menil Collection', location: {lat: 29.737368, lng: -95.398521}},
                {title: 'The Museum of Fine Arts Houston', location: {lat: 29.725798, lng: -95.390424}}
            ],
            styles: [
                {featureType: 'water', stylers: [{ color: '#0066ff' }]},
                {featureType: 'road.highway', elementType: 'geometry.stroke', stylers: [{ color: '#cc0044'}]}
            ] 
        }
        // Create the map!
        /*var octopus = {
            init: function() {
                mapView.init(),
                listView.init(),
            }

        }*/
       //var locationsList = ko.observableArray(Model.locations);
       // console.log(locationsList);

      /* var viewModel = {
            locationsList: ko.observableArray(locations)
        };
        ko.applyBindings(new viewModel);*/

        /*var mapView = {
            init: function() {

            }
        }*/
        var defaultIcon;
        var highlightedIcon;
     	function initMap() {

            // Constructor creates a new map
     		map = new google.maps.Map(document.getElementById('map'), {
     			center: {lat: 29.762778, lng: -95.383056},
	     		zoom: 11,
                styles: Model.styles
     		});
     		var largeInfowindow = new google.maps.InfoWindow();
            var bounds = new google.maps.LatLngBounds();
            defaultIcon = makeMarkerIcon('cc0044');
            highlightedIcon = makeMarkerIcon('0066ff');
            // Loop over all locations and create a marker and infowindow for each
     		for (var i = 0; i < Model.locations.length; i++) {
     			var position = Model.locations[i].location;
     			var title = Model.locations[i].title;
     			var marker = new google.maps.Marker({
     				map: map,
     				position: position,
     				title: title,
     				animation: google.maps.Animation.DROP,
                    icon: defaultIcon,
     				id: i                    
     			});
     			markers.push(marker);
                marker.addListener('click', function() {
                    populateInfoWindow(this, largeInfowindow);
                });

                bounds.extend(markers[i].position);
            }
            map.fitBounds(bounds);
     	}
        // When the marker click event fires, populateInfoWindow creates a window with information about the selected marker location
     	function populateInfoWindow(marker, infowindow) {
     		if (infowindow.marker != marker) {
     			infowindow.marker = marker;
     			infowindow.setContent('<div>' + marker.title + '</div>')
     			infowindow.open(map, marker);
                marker.setIcon(highlightedIcon);
                marker.setAnimation(google.maps.Animation.BOUNCE);
     			infowindow.addListener('closeclick', function(){
     				infowindow.marker = null;
                    marker.setIcon(defaultIcon);
                    marker.setAnimation(null);
     			});
       		}
     	}
        function makeMarkerIcon(markerColor) {
            var markerImage = new google.maps.MarkerImage(
                'http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|'+ markerColor +
                '|40|_|%E2%80%A2',
                new google.maps.Size(21, 34),
                new google.maps.Point(0, 0),
                new google.maps.Point(10, 34),
                new google.maps.Size(21,34))
            return markerImage;
        }
    </script>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAwYUgFAZRmyKAsqaKJdN7bT5kvFn7Pd3c&v=3&callback=initMap"></script>

</body>
</html>
